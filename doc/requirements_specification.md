# CCPM タスク管理ツール 要件定義書

## 概要
Critical Chain Project Management (CCPM) の原則に基づいた個人向けタスク進捗・バッファ管理ツール。
プロジェクト管理、タスク追跡、時間管理、およびCCPM特有のバッファ管理機能を提供する。

## 1. 機能要件

### 1.1 タスク管理
- タスクの作成、編集、削除
- タスクのステータス管理（未着手、進行中、完了など）
- タスクの優先度設定
- タスクの依存関係設定
- タスクの工数予実管理
  - 50%確率見積り（安全マージンを含まない現実的な見積り）の入力
  - 実績工数の記録
  - 予定vs実績の差異分析
  - 工数超過/削減のバッファへの影響計算
  - タスクごとの予実比率の履歴管理
  - 見積り精度の個人傾向分析（過小/過大見積り傾向）
  - 見積り補正係数の自動計算と提案
- タスクのカテゴリ分類
- タスクの期限設定
- タスクの検索とフィルタリング

### 1.2 時間トラッキング
- タスク作業時間の記録（開始/停止機能）
- 定常タスク（カテゴリ）の時間記録
  - 定常タスクタイプ（会議、レビュー、調査など）の選択
  - タイトル/簡易説明の入力
  - タグ付け機能（プロジェクト、種類など）
  - ワンクリックでの時間記録開始/終了
  - 定常タスク種類ごとの見積もり設定と実績集計
  - 定常タスク種類ごとのバッファ消費率計算
- 予定vs実績の比較表示
- タスク種別ごとの時間配分表示

### 1.3 プロジェクト管理
- プロジェクトの作成、編集、削除
- プロジェクトの基本情報管理（名前、説明、期間など）
- プロジェクトのステータス管理
- クリティカルチェーンの識別と表示
- プロジェクトバッファの管理
- フィーディングバッファの管理
- バッファ消費率の計算と表示
- バッファステータスの視覚化（緑/黄/赤の3段階）
- プロジェクトの進捗状況の表示
- プロジェクトの完了予測

### 1.4 予実管理と分析
- **見積り精度の追跡**:
  - ユーザーごとの見積り精度トレンド
  - タスク種類別の見積り精度分析
  - 見積り精度向上のための提案
- **進捗予測**:
  - 現在の実績に基づく完了予測
  - 予測完了日の自動更新
  - 遅延リスクの早期警告
- **リソース負荷分析**:
  - 日/週/月ごとの作業負荷予測
  - キャパシティと実績の比較
  - オーバーコミット状態の検出
- **実績データベース**:
  - 過去タスクの実績データ蓄積
  - 類似タスクの実績参照機能
  - 見積り時の実績データ提案
- **変動要因分析**:
  - 予実乖離の要因カテゴリ記録
  - 共通する変動要因の特定
  - 予防可能な遅延要因の分析

### 1.5 ダッシュボードと可視化
- プロジェクト概要ダッシュボード
- タスク一覧と状態表示
- バッファ消費のバーンダウンチャート
- 時系列でのバッファ消費トレンドグラフ
- プロジェクト完了予測ライン
- 作業負荷のヒートマップ
- 優先タスクのハイライト表示
- 定常タスクの時間配分円グラフ

## 2. 特殊機能要件

### 2.1 CCPM 特有機能
- 50%確率見積りの入力支援
- クリティカルチェーンの自動識別
- プロジェクトバッファの自動計算（クリティカルチェーン長の50%など）
- フィーディングバッファの自動計算
- バッファ消費率の計算と監視
- バッファ状態に基づく優先度の動的調整
- マルチタスク防止のための作業中タスク制限

### 2.2 バッファ管理
- バッファ消費率の計算（経過時間比率に対するバッファ消費比率）
- バッファステータスの3段階表示（緑: 0-33%, 黄: 34-67%, 赤: 68-100%）
- バッファ消費のトレンド分析
- バッファ回復のための対策提案
- バッファ消費異常の早期警告
- バッファ状態に基づくタスク優先度の自動調整

### 2.3 定常タスク管理（ハイブリッドアプローチ）
- 定常タスクのプロジェクト紐付け
  - 直前に作業していたプロジェクトへの自動紐付け機能
  - 必要に応じて紐付けプロジェクトの手動変更
  - プロジェクト請求枠への時間計上
- 定常タスクの性質に応じた分類管理
  - 予測可能な定常タスク → 予定枠として管理（定例会議、スプリントレビューなど）
  - 突発的な定常タスク → バッファ消費として管理（緊急レビュー、問い合わせ対応など）
  - 改善活動的な定常タスク → サブプロジェクトとして管理（プロセス改善、技術検証など）
- 定常タスク種類ごとの時間管理
  - 種類別の時間集計と分析
  - プロジェクト別・種類別のクロス集計
  - 定常タスク比率の適正化提案
- 定常タスクテンプレートの活用
  - 頻繁に発生する定常タスクのテンプレート化
  - プロジェクト紐付け情報を含むテンプレート

## 3. 非機能要件

### パフォーマンス要件
- 画面遷移：1秒以内
- データベース応答：500ms以内
- 同時接続ユーザー数：1-5人程度
- データ容量：1年で約10GB以内

### セキュリティ要件
- **ユーザー認証方式**:
  - Googleアカウントによるソーシャルログイン
    - Firebase AuthenticationまたはGoogle Identity Platformの利用
    - Googleアカウント連携のみ（初期段階）
  - JWT（JSON Web Token）による認証トークン管理
  - トークン有効期限の適切な設定（24時間）
- **アクセス制御**:
  - ユーザー自身のデータのみアクセス可能
  - 管理者アカウントの基本機能
- **アクセスログ**:
  - ログイン/ログアウト記録
  - 重要操作の監査ログ（30日間保持）

## 4. ユーザーインターフェース要件
- レスポンシブデザイン（デスクトップ優先、タブレット対応）
- 直感的なタスク管理UI
- ドラッグ＆ドロップによるタスク操作
- バッファ状態の視覚的表示
- ダッシュボード形式のプロジェクト概要
- ガントチャート形式のタスク依存関係表示
- バーンダウンチャートによるバッファ消費表示
- キーボードショートカットのサポート
- ダークモード/ライトモードの切り替え（将来対応）

## 5. データ要件
- ユーザーデータの永続化
- プロジェクト情報の保存
- タスク情報の保存
- 時間記録の保存
- バッファ消費履歴の保存
- 定常タスク記録の保存
- 予実データの履歴保存
- バックアップと復元機能

## 6. ユーザーストーリー

### 6.1 プロジェクト管理者として
1. **プロジェクト設定**: プロジェクトの基本情報を設定したい
   - *例*: プロジェクト名、説明、期間、目標などの設定
   - *例*: クリティカルチェーンの確認と調整
   - *例*: プロジェクトバッファの設定と監視

2. **進捗監視**: プロジェクトの進捗状況を監視したい
   - *例*: バッファ消費率の確認
   - *例*: クリティカルチェーン上のタスク進捗確認
   - *例*: 完了予測日の確認と調整

3. **リソース管理**: リソースの割り当てと負荷を管理したい
   - *例*: 作業負荷の確認と調整
   - *例*: オーバーコミットの検出と解消
   - *例*: 定常タスクの影響分析

### 6.2 タスク実行者として
1. **タスク管理**: 自分のタスクを管理したい
   - *例*: 担当タスクの確認と優先順位の把握
   - *例*: タスクの開始と完了の記録
   - *例*: 作業時間の記録と分析

2. **時間管理**: 作業時間を効率的に管理したい
   - *例*: タスク作業時間の記録
   - *例*: マルチタスクの防止
   - *例*: 集中時間の確保と記録

3. **進捗報告**: タスクの進捗を報告したい
   - *例*: 完了率の更新
   - *例*: 障害や遅延の報告
   - *例*: 予実差異の記録と説明

### 6.3 日常使用者として
1. **タスク管理**: 日々のタスクを効率的に管理したい
   - *例*: タスクの追加、編集、削除、ステータス変更
   - *例*: タスクの50%確率見積りを入力し、実績との差異を確認
   - *例*: タスク完了時に実績工数を記録し、見積り精度を振り返る
   - *例*: 工数超過がバッファにどう影響するかを即座に確認
   - *例*: タスク完了時に予実乖離の理由（「要件変更があった」「技術的困難があった」など）を記録
   - *例*: 自分の見積り傾向（常に20%程度過小見積りしている等）を確認し、次回の見積りに活かす
   - *例*: 類似の過去タスクの実績を参照して、より正確な見積りを行う

2. **定常タスク管理**: 会議や定例作業などの定常タスクを簡単に記録したい
   - *例*: 「コードレビュー: 認証機能PR#123」というタイトルで「レビュー」タグを付けて時間記録し、直前に作業していた「認証システム開発」プロジェクトに自動計上
   - *例*: 「週次チームミーティング」を「会議」タグで記録し、適切なプロジェクトに手動で振り分け
   - *例*: 突発的なクライアント問い合わせ対応をバッファ消費として記録し、プロジェクト進捗への影響を可視化
   - *例*: プロジェクトごとの定常タスク比率を確認し、間接作業の最適化ポイントを特定

3. **振り返りと改善**: 自分の作業パターンを振り返り改善したい
   - *例*: 週次/月次の作業時間配分の確認
   - *例*: 見積り精度の傾向分析
   - *例*: 効率的な作業時間帯の特定
   - *例*: バッファ消費パターンの分析と改善

## MVP（最小実行可能製品）の定義

MVPでは、CCPM の核となる機能に焦点を当て、個人ユーザーが基本的なタスク管理とバッファ監視を行えるようにします。

### MVP に含まれる機能（Must Have）
- **基本的なタスク管理**：作成、編集、削除、ステータス変更
- **50%確率見積りの入力**：安全マージンを含まない現実的な見積り
- **シンプルなプロジェクト管理**：プロジェクトの作成と基本情報管理
- **タスク依存関係の基本設定**：先行/後続タスクの設定
- **クリティカルチェーンの識別**：依存関係に基づくクリティカルパスの表示
- **プロジェクトバッファの管理**：バッファ消費率の計算と表示
- **バッファステータスの視覚化**：
  - 緑/黄/赤の3段階表示
  - バッファ消費のバーンダウンチャート表示
  - 時系列でのバッファ消費トレンドグラフ
  - プロジェクト完了予測ラインの表示
- **基本的な時間トラッキング**：タスク作業時間の記録（開始/停止）
- **定常タスク基本管理**: 
  - 定常タスクの記録（開始/停止機能）
  - 定常タスク種類（会議、レビューなど）の選択
  - タイトル/簡易説明の入力
  - タグ付け機能（基本的なタグのみ）
  - 直前プロジェクトへの自動紐付け
  - プロジェクト請求枠への時間計上
- **工数予実管理**：
  - 予定工数の登録
  - 実績工数の記録
  - 予実差異の計算と表示
  - バッファへの影響の可視化
  - 簡易的な予実乖離要因の記録（コメント機能）
- **シンプルなダッシュボード**：現在の作業状況とバッファ状態の概要表示

### MVP 後の拡張機能（Should Have）
- **フィーディングバッファ管理**：非クリティカルパスからの合流点でのバッファ
- **バッファトレンド分析**：
  - 詳細な時系列分析
  - バッファ消費パターンの予測
  - 異常消費の検出と警告
- **マルチタスク防止機能**：同時進行タスクの制限
- **進捗予測**：現在のバッファ消費率に基づく完了日予測
- **実績データベース**：過去タスクの実績時間参照
- **高度な予実管理**:
  - 見積り精度の個人傾向分析
  - 見積り補正係数の自動計算
  - 類似タスクの実績参照機能
  - 予実乖離の要因カテゴリ分析
- **高度な定常タスク管理**:
  - 定常タスク種類ごとのバッファ影響分析
  - 予測可能/突発的/改善活動的タスクの分類管理
  - 定常タスクテンプレートの作成と再利用
  - 定常タスク比率の分析と最適化提案
  - プロジェクト別・種類別のクロス集計レポート

### 将来的な拡張機能（Could Have）
- **通知APIシステム**：外部ツールへの通知連携
- **詳細なレポート機能**：カスタマイズ可能なレポート生成
- **高度な依存関係管理**：複雑な依存関係の視覚化
- **データエクスポート**：CSV等の形式でのデータ出力
- **デスクトップ通知**：システムレベルの通知
- **定常タスク高度分析**:
  - 定常タスクパターンの機械学習による予測
  - 定常タスク最適化のための自動提案
  - 外部カレンダーとの連携による定常タスク自動登録

### 対象外機能（Won't Have）
- **チーム連携/コラボレーション機能**
- **複雑な権限管理**
- **オフライン使用**
- **モバイルアプリ対応**
- **外部サービスとの双方向連携**

## 将来的な拡張候補機能

### 優先度高（Should Have）
- **ポモドーロテクニック統合**:
  - 25分作業/5分休憩のサイクル管理
  - タスク実行時のポモドーロタイマー連動
  - 集中時間の統計と基本分析
  
- **自動振り返り**:
  - 週次/月次の自動振り返りレポート生成
  - 生産性指標の可視化
  - 時間使用パターンの分析

- **ショートカットとクイックアクション**:
  - キーボードショートカットの充実
  - よく使う操作のワンクリックアクション
  - タスク状態変更の簡易化

- **基本的な可視化・分析機能**:
  - タスク完了率のトレンド
  - バッファ消費パターンの可視化
  - プロジェクト進捗の時系列表示

### 優先度中（Could Have）
- **コミュニケーションツール連携**:
  - Slack/Teamsへの進捗レポート送信
  - 定期的なステータスアップデート
  - バッファ警告の通知

- **テーマとカスタマイズ**:
  - ダークモード/ライトモード
  - 基本的なカラーテーマ選択
  - ダッシュボードのカスタマイズ

### 将来検討（Won't Have for Now）
- **AI支援機能**:
  - タスク見積り精度向上のためのAI提案
  - 過去の実績に基づく作業時間予測
  - 最適なタスク順序の提案
  - （データ構造は将来の実装を考慮）

- **カレンダー連携**:
  - Google/Outlookカレンダーとの双方向同期
  - 会議などの予定の自動タスク化

- **開発ツール連携**:
  - JIRA連携
  - GitHub/GitLabのIssue/PRとの連携

- **高度な分析機能**:
  - 機械学習による完了予測
  - リスク要因の早期警告システム
  - 改善アクションの自動提案

- **オフライン対応**:
  - オフライン作業時の同期
  - PWA対応
