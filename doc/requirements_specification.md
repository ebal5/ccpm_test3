# CCPM タスク管理ツール 要件定義書

## 概要
Critical Chain Project Management (CCPM) の原則に基づいた個人向けタスク進捗・バッファ管理ツール。
プロジェクト管理、タスク追跡、時間管理、およびCCPM特有のバッファ管理機能を提供する。

## 1. コア機能

### 1.1 タスク管理
- タスク作成/編集/削除
- タスク情報: 
  - ID
  - 名前
  - 説明
  - 見積時間（50%確率見積り）
  - バッファ量
  - 実作業時間
  - 依存関係
  - 開始/完了日
  - 優先度
  - ステータス
- プロジェクト/プロファイルによるタスク分類

### 1.2 時間トラッキング
- タスク作業時間の記録（開始/停止機能）
- 定常タスク（カテゴリ）の時間記録
- 予定vs実績の比較表示
- タスク種別ごとの時間配分表示

### 1.3 CCPM 管理
- クリティカルチェーンの表示
- バッファ消費率の計算と可視化
- タスク依存関係の設定・表示

### 1.4 バッファ管理システム
- **プロジェクトバッファ**: プロジェクト全体に対する時間バッファの管理
- **フィーディングバッファ**: 非クリティカルパスからクリティカルパスへの合流点でのバッファ管理
- **バッファ消費率計算**: 完了したタスクの割合に対するバッファ消費の割合を計算
  - バッファステータス: 緑(0-33%)、黄(34-66%)、赤(67-100%)の視覚的表示
- **バッファトレンド分析**: バッファ消費のトレンドを時系列で表示

### 1.5 タスク見積りシステム
- **50%確率見積り**: 従来の「安全マージン込み」ではなく50%の確率で完了できる時間を見積もる機能
- **実績データベース**: 過去の同様タスクの実績時間を参照できる機能
- **見積り補正係数**: ユーザーの見積り傾向に基づいた補正係数の自動計算

### 1.6 タスク依存関係管理
- **先行/後続タスク設定**: タスク間の依存関係を設定
- **クリティカルパス自動計算**: 依存関係に基づいてクリティカルパスを自動識別
- **依存関係の視覚化**: ネットワーク図での依存関係表示

### 1.7 マルチタスク防止機能
- **アクティブタスク制限**: 同時に進行中にできるタスク数を制限
- **タスク切り替えアラート**: 頻繁なタスク切り替えに警告
- **フォーカスモード**: 現在のタスクに集中するためのUI

### 1.8 進捗管理
- **進捗報告システム**: タスクの完了率や残り時間の報告
- **トラフィックライトシステム**: プロジェクト状態の視覚的表示
- **予測完了日計算**: 現在の進捗とバッファ消費率に基づく完了日予測

### 1.9 通知APIシステム
- **Webhook連携**: Discord、Slack、Microsoft Teams、Telegram等の主要チャットプラットフォームへのWebhook送信
- **通知テンプレート**: イベントタイプ別にカスタマイズ可能な通知テンプレート
- **通知トリガー設定**: どのイベントでどの通知を送信するかの設定機能
- **API認証**: 外部からの通知リクエスト用のAPIキー管理

#### 1.9.1 通知イベントタイプ
- タスク状態変更: タスクの状態変更時（開始、完了、保留など）
- バッファアラート: バッファ消費が閾値（黄色、赤色）を超えた場合
- 期限アラート: タスク期限が近づいた場合
- 依存関係解決: 先行タスクが完了し、次のタスクに着手可能になった場合
- 日次サマリー: 一日の終わりの進捗サマリー
- 週次レポート: 週間のプロジェクト状況レポート

#### 1.9.2 通知データフォーマット
- **JSON形式**: すべての通知は標準的なJSON形式で送信
- **リッチフォーマット**: チャットツール専用のリッチフォーマット（カード、ボタンなど）のサポート
- **変数置換**: テンプレート内の変数をタスクデータで動的に置換

#### 1.9.3 API連携機能
- **双方向連携**: 外部ツールからのコマンド受信機能（オプション）
- **バッチ通知**: 複数通知のバッチ処理機能
- **エラーハンドリング**: 通知送信失敗時のリトライとログ記録

## 2. 技術選定
- **フロントエンド**: Taipy (Python ベースの Web アプリフレームワーク)
- **データベース**: SQLite (将来的には他 RDBMS に移行可能なよう抽象化)
- **デプロイ**: ローカルサーバー (個人利用向け)

## 3. 非機能要件
- **ユーザーインターフェース**: ダークテーマ固定
- **パフォーマンス**: 数千タスク程度の処理に対応
- **セキュリティ**: 標準的な Web アプリセキュリティ (外部公開しない前提)

## 4. 将来的な拡張機能 (MVP 後)
- データエクスポート (CSV など)
- デスクトップ通知機能
- レポート生成機能
- Electron によるデスクトップアプリ化

## 5. 対象外機能
- チーム連携/コラボレーション機能
- オフライン使用
- 複雑な権限管理

## 6. ユーザーストーリー

### 6.1 プロジェクト管理者として
1. **プロジェクト作成**: 新しいプロジェクトを作成し、全体の目標完了日を設定したい
   - *例*: "新商品開発プロジェクト"を作成し、3ヶ月後の完了を目指す

2. **クリティカルチェーン設定**: プロジェクト内のクリティカルな作業を識別し連鎖させたい
   - *例*: 設計→試作→テスト→製造の流れを最短で完了できるよう計画

3. **バッファ配分**: プロジェクト全体のバッファと各合流点のフィーディングバッファを設定したい
   - *例*: プロジェクト全体に20日、主要合流点に5日ずつのバッファを配分

4. **プロジェクト進捗確認**: プロジェクト全体の進捗とバッファ消費状況を一目で確認したい
   - *例*: ダッシュボードでプロジェクトが「緑」状態か「黄」状態か「赤」状態かを確認

5. **通知チャンネル設定**: プロジェクト別に通知を送信するチャットチャンネルを設定したい
   - *例*: 「新商品開発プロジェクト」の通知はSlackの#new-product-devチャンネルに送信

6. **重要イベント通知**: プロジェクトの重要なマイルストーンやリスクを自動的にチームに通知したい
   - *例*: バッファ消費率が「赤」レベルになったときに緊急アラートを送信

7. **定期レポート自動化**: 週次・月次のプロジェクト状況レポートを自動的にステークホルダーに送信したい
   - *例*: 毎週金曜日にプロジェクトの進捗状況とバッファ残量の要約を経営陣に送信

### 6.2 タスク実行者として
1. **タスク確認**: 自分が次に取り組むべきタスクを明確に知りたい
   - *例*: ログイン後、優先度順に並んだタスクリストから次のタスクを選択

2. **タスク見積り**: 各タスクの作業時間を「50%確率見積り」で登録したい
   - *例*: 「デザインレビュー」タスクを過去の実績を参考に「6時間」と見積もる

3. **時間トラッキング**: タスク作業の開始・終了時間を記録したい
   - *例*: 「コーディング」タスクの作業開始ボタンを押し、終了時に停止ボタンを押す

4. **進捗報告**: タスクの進捗状況を報告したい
   - *例*: 「テスト作成」タスクの完了率を70%と報告し、残りの見込み時間を入力

5. **依存タスク確認**: 自分のタスクが依存している先行タスクの状況を確認したい
   - *例*: 「実装」タスクが依存している「設計」タスクの完了状況を確認

6. **タスク通知受信**: 自分に関連するタスクの状態変更や期限について通知を受け取りたい
   - *例*: 自分の先行タスクが完了したら、次のタスクに着手できることをDiscordで通知

7. **外部からのタスク更新**: チャットツールから簡単なコマンドでタスク状態を更新したい
   - *例*: Slackで「/ccpm complete TASK-123」と入力してタスクを完了としてマーク

8. **タイムトラッキング連携**: チャットツールからタスクの開始・停止を制御したい
   - *例*: Teamsで「/ccpm start TASK-456」とタイプしてタスクの作業を開始記録

### 6.3 日常使用者として
1. **プライオリティ管理**: 複数プロジェクトにまたがるタスクの優先順位を設定したい
   - *例*: プロジェクトAとBのタスクが同時に割り当てられている場合、バッファ消費率に基づいて優先順位を決定

2. **定常タスク管理**: 会議や定例作業などの定常タスクをスケジュール化したい
   - *例*: 毎週月曜の朝に発生する「週次ミーティング」を定常タスクとして設定

3. **日次計画**: 今日取り組むタスクのリストを作成し、時間配分を計画したい
   - *例*: 朝に今日の作業予定を立て、各タスクにどれくらい時間を割くか決定

4. **集中時間確保**: マルチタスクを避け、特定のタスクに集中する時間を確保したい
   - *例*: 「重要設計書作成」に3時間の中断なし集中時間を設定し、通知を制限

5. **振り返り分析**: 完了したタスクの見積りと実績を比較して、今後の見積り精度を向上させたい
   - *例*: 過去1ヶ月の「コーディング」カテゴリのタスクで見積りよりも平均20%時間がかかっていることを把握

6. **パーソナル通知設定**: 自分専用の通知設定をカスタマイズしたい
   - *例*: 高優先度タスクの通知はTelegramに、その他はメールに受け取るよう設定

7. **通知頻度調整**: 通知の頻度や時間帯を自分の作業スタイルに合わせて調整したい
   - *例*: 集中作業時間中は通知を抑制し、作業後にまとめて受け取る設定

8. **モバイル通知**: 外出中でもモバイルアプリで重要な通知を受け取りたい
   - *例*: クリティカルパス上のタスクが遅延した場合、スマートフォンに通知を受信

### 6.4 管理者として
1. **API鍵管理**: 外部ツール用のAPIキーを発行・管理したい
   - *例*: Slackインテグレーション用の新しいAPIキーを作成し、アクセス権を制限

2. **通知テンプレートカスタマイズ**: 組織のニーズに合わせて通知内容とフォーマットをカスタマイズしたい
   - *例*: タスク完了通知に会社のブランドカラーを使用したカードフォーマットを設定

3. **通知ログ確認**: 送信された通知の履歴とステータスを確認したい
   - *例*: 過去1週間に送信された全ての通知とその配信状況を確認
